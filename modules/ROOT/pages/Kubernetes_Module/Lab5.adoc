= Lab 5 - Deploy App on Kubernetes using Helm
Bryan Kribbs <bakribbs@us.ibm.com>
v1.0, 2019-05-28
:toc:
:imagesdir: images

== Introduction

In this lab, you will learn about how to deploy applications to Kubernetes using Helm. We will be using pre-created helm charts for the deployment.

== Prerequisites

- You will need an IBM Account for https://cloud.ibm.com/[IBM Cloud]
- Downloaded and installed the IBM Cloud CLI at https://cloud.ibm.com/docs/cli?topic=cloud-cli-getting-started#step1-install-idt[IBM Cloud CLI Installation]. Follow the instructions for your computer's operating system.
- Downloaded and installed the Helm CLI at https://github.com/helm/helm#install[Helm CLI Installation].
- Downloaded and installed the Kubernetes CLI at https://kubernetes.io/docs/tasks/tools/install-kubectl/[Kubernetes CLI Installation]. Follow the instructions for your computer's operating system.

== IBM Cloud Login

Start by opening a web browser and navigating to https://cloud.ibm.com/[IBM Cloud].

image::Cloud-Login.png[]

Next *_login_* with your IBM Cloud login you created.  After login you will be navigated to your *Cloud Dashboard*. 

image::IBM_Cloud_Dashboard.png[]

On the *Cloud Dashboard* in the resource summary section, select *Kubernetes Clusters*.

image::CL_Dash_Kube.png[][]

In Kubernetes Cluster list, select the cluster you would like to access. Make sure the cluster you select has a blue square icon next to it.  

== Accessing the Kubernetes Cluster

Once on the *Overview* screen of your Kubernetes cluster in the top right corner, select *Connect via CLI* and follow the onscreen instructions.  

image::kube-connect.png[]

Once logged in with the *CLI* we need to get the sample application.

== Getting the Sample Application

Download the sample application from Github: https://github.com/ibm-cloud-architecture/cloudnative_sample_app[Sample App]

== Deploying the Sample Application using Helm

In this section we will deploy the sample application that you downloaded using the Helm CLI in your terminal or cmd prompt.
The helm charts are already pre-created in the `/chart` directory of the application directory.  

=== Looking at the Charts


=== Checking the Namespace
To check the namespace you are deploying your application to run the following command:

.View Namespace
----
kubectl config view | grep namespace:
----

Always double check the namespace your Kubectl context is set for to make sure you are deploying the application where you would like it to be in your Kubernetes Cluster.

=== Application Deploy

To deploy your application we are going to use the Helm CLI Commands. First start by making sure the Helm Tiller is properly installed:

.Helm Tiller Install
---- 
helm init
----

Once installed we can deploy our charts. To do that run the following:

.Helm Install
----
helm install --name cloudnativesample chart/cloudnativesampleapp
----

Make sure when you run this command you are in the home directory of the sample application.